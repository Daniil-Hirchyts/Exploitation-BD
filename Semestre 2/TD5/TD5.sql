
--Q1
SELECT categorieService, COUNT(nomService) as "NB SERVICES"
FROM Services
GROUP BY categorieService

--Q2
SELECT villeClient
FROM (SELECT villeClient, COUNT(idClient) as nbClient
FROM Clients
GROUP BY villeClient)
WHERE nbClient>=3

--Q3
SELECT nomCamping, AVG(salaireEmploye) AS "SALAIRE MOYEN"
FROM Employes e JOIN Campings c ON e.idCamping=c.idCamping
GROUP BY nomCamping

--Q4
SELECT nomCamping
FROM(SELECT nomCamping, COUNT(idEmploye) AS nbEmploye
FROM Employes e JOIN Campings c ON e.idCamping=c.idCamping
GROUP BY nomCamping)
WHERE nbEmploye>3

--Q5
SELECT nomClient,prenomClient,COUNT(l.idClient) AS "NB LOCATIONS"
FROM Locations l JOIN Clients c ON l.idClient=c.idClient
GROUP BY nomClient,prenomClient,l.idClient
ORDER BY "NB LOCATIONS" DESC;

--Q6
SELECT nomCamping
FROM(SELECT nomCamping, AVG(salaireEmploye) as salaireMoyen
FROM Employes e JOIN Campings c ON e.idCamping=c.idCamping
GROUP BY nomCamping)
WHERE salaireMoyen>1400

--Q7
SELECT nomClient,prenomClient
FROM Clients c JOIN Locations l ON l.idClient=c.idClient
			   JOIN Bungalows b ON l.idBungalow=b.idBungalow
GROUP by nomClient,prenomClient,l.idClient
HAVING COUNT(DISTINCT idCamping) =2
ORDER BY nomClient;

--Q8
SELECT nomBungalow,"NB SERVICES"
FROM(
SELECT nomBungalow,p.idBungalow, COUNT(idService) as "NB SERVICES"
FROM Bungalows b LEFT JOIN Proposer p ON b.idBungalow=p.idBungalow
GROUP BY nomBungalow,p.idBungalow)
ORDER BY "NB SERVICES" DESC

--Q9
SELECT nomCamping
FROM(SELECT nomCamping,c.idCamping,COUNT(idBungalow) as nbBungalows
FROM Campings c JOIN Bungalows b ON c.idCamping=b.idCamping
WHERE superficieBungalow<65
GROUP BY nomCamping,c.idCamping)
ORDER BY nbBungalows

--Q10
SELECT nomCamping
FROM (SELECT nomCamping, MIN(salaireEmploye) as salaireMin
FROM Employes e JOIN Campings c ON e.idCamping=c.idCamping
GROUP BY nomCamping)
WHERE salaireMin>=1000

--Q11
SELECT nomBungalow
FROM(SELECT b.idBungalow,nomBungalow, COUNT(idService) as nbServices
FROM Proposer p JOIN Bungalows b ON p.idBungalow=b.idBungalow
GROUP BY b.idBungalow,nomBungalow)
WHERE nbServices=(SELECT COUNT(idService) FROM Proposer p JOIN Bungalows b ON p.idBungalow=b.idBungalow WHERE b.nomBungalow='Le Royal')


--Q12
SELECT nomBungalow, COUNT(idLocation) AS "NB LOCATIONS"
FROM Bungalows b LEFT JOIN Locations l ON b.idBungalow=l.idBungalow
				 JOIN Campings c ON b.idCamping=c.idCamping
WHERE nomCamping='La DÃ©charge Monochrome'
GROUP BY nomBungalow,l.idBungalow
ORDER BY "NB LOCATIONS" DESC;

--Q13
SELECT nomClient,prenomClient
FROM(SELECT c.idClient,nomClient,prenomClient, COUNT(idLocation) as nbLoc, AVG(montantLocation) as moyenneLoc
FROM Clients c JOIN Locations l ON c.idClient=l.idClient
GROUP BY c.idClient,nomClient,prenomClient)
WHERE nbLoc>=2 AND moyenneLoc>1100;

--Q14
SELECT nomBungalow
FROM(SELECT nomBungalow, COUNT(idService) as nbServ
FROM Bungalows b JOIN Proposer p ON b.idBungalow=p.idBungalow
GROUP BY b.idBungalow,nomBungalow)
WHERE nbServ=(SELECT MAX(COUNT(idService)) FROM Bungalows b JOIN Proposer p ON b.idBungalow=p.idBungalow
GROUP BY b.idBungalow,nomBungalow)
