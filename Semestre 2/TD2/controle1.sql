
/*  RO1 : Le nom et le prénom des clients qui habitent
dans une ville où il y a un camping. */
SELECT nomClient, prenomClient
FROM Clients
WHERE villeClient IN
(SELECT villeCamping
FROM Campings) ;

/* RO2 : Le nom et le prénom des subordonnés des subor-
donnés de 'Marc Assin' (le chef de leur chef est 'Marc
Assin'). */
SELECT nomEmploye, prenomEmploye
FROM Employes31
WHERE idEmployeChef IN
(SELECT idEmploye
FROM Employes
WHERE idEmployeChef IN
(SELECT idEmploye
FROM Employes
WHERE nomEmploye = 'Assin'
AND prenomEmploye = 'Marc')) ;

/* RO3 : Le montant total des locations effectuées dans
le camping "The White Majestic */
SELECT SUM (montantLocation) AS "Montant Total"
FROM Locations 1
JOIN Bungalows b ON l.idBungalow = b. idBungalow
JOIN Campings c ON b. idCamping = c.idCamping
WHERE nomCamping = 'The White Majestic';

/* RO4: Le nombre de clients qui ont loué un bungalow
dans la même ville où ils habitent. */
SELECT COUNT (DISTINCT cl.idClient) AS "NB CLIENTS"
FROM Clients
cl
JOIN Locations l ON cl.idClient = l.idClient
JOIN Bungalows b ON l.idBungalow
= b.idBungalow
JOIN Campings ca ON b. idCamping
= ca.idCamping
WHERE villeClient = villeCamping;

/* R05: Le nom des clients, dans l'ordre lexicographique,
qui ont loué des bungalows à Palavas l'été 2021 (ils
étaient là un jour entre juin et août) */
SELECT nomClient
FROM Clients
WHERE idClient IN
(SELECT idClient
FROM Locations 1
JOIN Bungalows b ON l.idBungalow = b.idBungalow
JOIN Campings ca ON b.idCamping = ca.idCamping
WHERE villeCamping
= Palavas
AND dateDebut <= '31/08/2021'
AND dateFin >= '01/06/2021')
ORDER BY nomClient;

/* R06: Le nom des bungalows qui proposent la service
'TV' et qui n'ont pas reçu de clients. */
SELECT nomBungalow
FROM
Bungalows
WHERE idbungalow
IN
(SELECT b. idBungalow
FROM Bungalows b
JUIN Proposer
b. idBungalow = p. idBungalow
HOiN services S
ON s.idService = p.idservice
WHERE nomService
INTERSECT
SELECTidBungalow
FROM Bungalows
WHERE idBungalow NOT IN (
SELECT idBungalow
FROM Locations)) ;

/* R07: Le nom des campings qui ne payent pas leurs
employés le salaire minimum. */
SELECT nomCamping
FROM Campings
WHERE idCamping NOT IN
(SELECT idCamping
FROM Employes
WHERE idCamping IS NOT NULL
AND salaireEmploye
(SELECT MIN (salaireEmploye)
FROM Employes e)) ;

/* R08 : L'identifiant et le nom des bungalows qui pro-
posent une service 'Inutile' ou qui ne proposent pas de
service, avec le nom de la service proposé. */
SELECT DISTINCT b. idBungalow, nomBungalow, NVL (categorieService, 'Rien') AS "SERVICE PROPOSE"
FROM Bungalows b
LEFT JOIN Proposer p ON b. idBungalow = p. idBungalow
LEFT JOIN Services s ON s.idService = p.idService
WHERE categorieService 'Inutile'
OR categorieService IS NULL;

/* Bonus: Répondre à R01 en utilisant WHERE EXISTS. */
SELECT nomClient, prenomClient
FROM Clients
WHERE EXISTS
(SELECT *
FROM Campings
WHERE villeClient = villeCamping) ;