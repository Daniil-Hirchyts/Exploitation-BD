-- Q1
select NOM, PRENOM, ADRESSE
from DEMANDEUR

-- Q2
SELECT NOME, ADRE
FROM ENTREPRISE
WHERE ADRE LIKE '%USA%'

-- Q3
SELECT DISTINCT NOME, ADRE
FROM ENTREPRISE
         JOIN OFFRE O on ENTREPRISE.NUME = O.NUME

-- Q4
SELECT QUALIF
FROM OFFRE
WHERE SALAIRE > 3000

-- Q5
SELECT DISTINCT NOM, PRENOM
FROM DEMANDEUR
         JOIN OFFRE O on DEMANDEUR.QUALIF = O.QUALIF

-- Q6
SELECT NOM, NUMD
FROM DEMANDEUR
MINUS
SELECT NOM, NUMD
FROM DEMANDEUR
         JOIN OFFRE O on DEMANDEUR.QUALIF = O.QUALIF

-- Q7
SELECT NOME
FROM ENTREPRISE
MINUS
SELECT NOME
FROM ENTREPRISE
         JOIN OFFRE O on ENTREPRISE.NUME = O.NUME

-- Q8
SELECT DISTINCT NOME
FROM ENTREPRISE
WHERE ADRE LIKE '%USA%'
UNION
SELECT NOME
FROM ENTREPRISE
         JOIN OFFRE O on ENTREPRISE.NUME = O.NUME
WHERE SALAIRE >= 2000

-- Q9 (!)
SELECT NOME
FROM ENTREPRISE
         JOIN OFFRE O on ENTREPRISE.NUME = O.NUME
MINUS
SELECT NOME
FROM ENTREPRISE
         JOIN OFFRE O on ENTREPRISE.NUME = O.NUME
WHERE CONTRAT <> 'CDI'

--Q10 (TOUS)
SELECT E.NOME
FROM ENTREPRISE E
MINUS
SELECT NOME
FROM (SELECT NOME, CONTRAT
      FROM ENTREPRISE,
           OFFRE
      MINUS
      SELECT NOME, CONTRAT
      FROM ENTREPRISE E2
               JOIN OFFRE O2 on E2.NUME = O2.NUME)

-- Q11
SELECT NOME
FROM ENTREPRISE
         JOIN OFFRE O on ENTREPRISE.NUME = O.NUME
WHERE QUALIF = 'Developpeur'
INTERSECT
SELECT NOME
FROM ENTREPRISE
         JOIN OFFRE O on ENTREPRISE.NUME = O.NUME
WHERE QUALIF = 'AdminSys'

-- Q12 (AU MOINS 2)
SELECT DISTINCT O.NUME
FROM OFFRE O
         JOIN OFFRE O2 ON O.NUME = O2.NUME
WHERE O2.NUMO <> O.NUMO

-- Q13
SELECT DISTINCT D.NOM, D.PRENOM
FROM DEMANDEUR D
         JOIN OFFRE O on D.QUALIF = O.QUALIF
         JOIN OFFRE O2 on D.QUALIF = O2.QUALIF
         JOIN OFFRE O3 on D.QUALIF = O3.QUALIF
WHERE O2.NUMO <> O.NUMO
  AND O3.NUMO <> O.NUMO
  AND O2.NUMO <> O3.NUMO

-- Q14*
SELECT DISTINCT NOM, PRENOM, NUMD
FROM DEMANDEUR D
         JOIN OFFRE O ON D.QUALIF = O.QUALIF
MINUS
(SELECT DISTINCT NOM, PRENOM, NUMD
 FROM DEMANDEUR D
          JOIN OFFRE O ON D.QUALIF = O.QUALIF
 WHERE SALAIRE <= 1600
 INTERSECT
 SELECT DISTINCT NOM, PRENOM, NUMD
 FROM DEMANDEUR D
          JOIN OFFRE O ON D.QUALIF = O.QUALIF
          JOIN OFFRE O2 on D.QUALIF = O2.QUALIF
 WHERE O.SALAIRE > 2000
   AND O2.SALAIRE > 2000
   AND O.NUMO <> O2.NUMO)

-- Q15* (MAX)
SELECT NUMO
FROM OFFRE
WHERE SALAIRE IN
      (SELECT MAX(salaire)
       FROM OFFRE);

-- Q16*
SELECT NOM, PRENOM
FROM DEMANDEUR
WHERE QUALIF IN (SELECT QUALIF
                 FROM DEMANDEUR
                 WHERE NOM = 'Dalors') AND NOM <> 'Dalors'

