-- Q1 Editer (c.a.d. donner la liste) les libellés des produits.

SELECT Distinct LIB
FROM PRODUIT

-- Q2 Editer la liste des noms des clients

SELECT DISTINCT NOM
FROM CLIENT

-- Q3 Editer tous les produits dont la quantité en stock est supérieure ou égale à 50.

SELECT *
FROM PRODUIT
WHERE PRODUIT.QS >= 50

-- Q4 Editer tous les achats dont la quantité achetée est strictement supérieure à 12.

SELECT *
FROM ACHAT
WHERE ACHAT.QA > 12

-- Q5 Editer les quantités en stock et les couleurs des lampes (i.e. des produits dont le libellé est 'Lampe')

SELECT PRODUIT.QS, PRODUIT.COUL
FROM PRODUIT
WHERE PRODUIT.LIB = 'Lampe'

-- Q6 Editer les numéros des crayons de luxe dont la quantité en stock est supérieure ou égale à 20.

SELECT PRODUIT.NP
FROM PRODUIT
WHERE PRODUIT.LIB = 'Crayon Luxe' AND PRODUIT.QS >= 20

-- Q7 Editer les numéros des clients ayant fait au moins un achat de quantité supérieure ou égale à 10.

SELECT DISTINCT ACHAT.NCLI
FROM ACHAT
WHERE ACHAT.QA >= 10

-- Q8 Editer les numéros des clients dont le nom commence par un J et contient la lettre a.

SELECT CLIENT.NCLI
FROM CLIENT WHERE CLIENT.NOM LIKE 'J%a%'

-- Q9 Dresser la liste des numéros des clients qui ont acheté des lampes.

SELECT DISTINCT ACHAT.NCLI
FROM ACHAT, PRODUIT
WHERE ACHAT.NP = PRODUIT.NP AND PRODUIT.LIB = 'Lampe'

-- Q10 Dresser la liste des numéros des clients ayant acheté des lampes rouges

SELECT DISTINCT ACHAT.NCLI
FROM ACHAT, PRODUIT
WHERE ACHAT.NP = PRODUIT.NP AND PRODUIT.LIB = 'Lampe' AND PRODUIT.COUL = 'Rouge'

-- Q11 Dresser la liste des produits (libellé) dont au moins un achat est de quantité supérieure ou égale à 13.

SELECT DISTINCT PRODUIT.LIB
FROM PRODUIT, ACHAT
WHERE PRODUIT.NP = ACHAT.NP AND ACHAT.QA >= 13

-- Q12 Dresser la liste des noms des clients qui ont acheté des crayons de luxe en quantité supérieure ou égale à 2.

SELECT DISTINCT CLIENT.NOM
FROM CLIENT, ACHAT, PRODUIT
WHERE CLIENT.NCLI = ACHAT.NCLI AND ACHAT.NP = PRODUIT.NP AND PRODUIT.LIB = 'Crayon Luxe' AND ACHAT.QA >= 2

-- Q13 Nunéros des clients n'ayant pas acheté de crayon.

SELECT CLIENT.NCLI
FROM CLIENT
WHERE CLIENT.NCLI NOT IN (SELECT DISTINCT ACHAT.NCLI FROM ACHAT, PRODUIT WHERE ACHAT.NP = PRODUIT.NP AND PRODUIT.LIB = 'Crayon')

-- Q14 Nom et numéro des clients ayant fait des achats (au moins un et toujours fait des achats dont la quantité est supérieure (strict) à 3.

SELECT DISTINCT CLIENT.NOM, CLIENT.NCLI
FROM CLIENT
JOIN ACHAT A on CLIENT.NCLI = A.NCLI
WHERE A.QA > 3

-- Q15 Numéro des produits qu'aucun client n'a acheté.

SELECT PRODUIT.NP
FROM PRODUIT
WHERE PRODUIT.NP NOT IN (SELECT DISTINCT ACHAT.NP FROM ACHAT)

-- Q16 Nom et numéro des clients ayant acheté une Lampe et une Agrafeuse.

SELECT CLIENT.NCLI, CLIENT.NOM
FROM CLIENT
WHERE CLIENT.NCLI IN (SELECT DISTINCT ACHAT.NCLI FROM ACHAT, PRODUIT WHERE ACHAT.NP = PRODUIT.NP AND PRODUIT.LIB = 'Lampe') AND CLIENT.NCLI IN (SELECT DISTINCT ACHAT.NCLI FROM ACHAT, PRODUIT WHERE ACHAT.NP = PRODUIT.NP AND PRODUIT.LIB = 'Agrafeuse')

-- Q17 Nom et numéro des clients ayant acheté tous les produits.

SELECT CLIENT.NCLI, CLIENT.NOM
FROM CLIENT
WHERE CLIENT.NCLI IN (SELECT DISTINCT ACHAT.NCLI FROM ACHAT)

-- Q18 Inserer un achat pour le client 101 sur le sur produit 9.

INSERT INTO achat VALUES (101,9,12);

-- Q19 Numéros des produits qui ont été acheté par au moins deux clients.

SELECT PRODUIT.NP
FROM PRODUIT
WHERE PRODUIT.NP IN (SELECT DISTINCT ACHAT.NP FROM ACHAT GROUP BY ACHAT.NP HAVING COUNT(ACHAT.NP) >= 2)

-- Q20 (*) Libellé et couleur des produits qui ont été acheté par au moins deux clients.

SELECT PRODUIT.LIB, PRODUIT.COUL
FROM PRODUIT
WHERE PRODUIT.NP IN (SELECT DISTINCT ACHAT.NP FROM ACHAT GROUP BY ACHAT.NP HAVING COUNT(ACHAT.NP) >= 2)

-- Q21 (*) Numéro du produit, dont la quantité en stock est maximale.

SELECT PRODUIT.NP
FROM PRODUIT
WHERE PRODUIT.QS = (SELECT MAX(PRODUIT.QS) FROM PRODUIT)

-- Q22 (*) Nom des clients qui ont acheté les produits achetés par le client 103 (client 103 compris).

SELECT DISTINCT CL.NOM
FROM CLIENT CL
JOIN ACHAT A on CL.NCLI = A.NCLI
WHERE A.NCLI = 103 OR A.NP IN (SELECT A.NP FROM ACHAT A WHERE A.NCLI = 103)


-- Q23 (*) Nom et numéro des clients qui ont acheté tous les produits achetés par le client 103.

SELECT CLIENT.NCLI, CLIENT.NOM
FROM CLIENT
WHERE CLIENT.NCLI IN (SELECT DISTINCT ACHAT.NCLI FROM ACHAT WHERE ACHAT.NP IN (SELECT DISTINCT ACHAT.NP FROM ACHAT WHERE ACHAT.NCLI = 103)) AND CLIENT.NCLI <> 103